============================= test session starts =============================
platform win32 -- Python 3.12.0, pytest-9.0.2, pluggy-1.6.0 -- C:\Users\MUHAMMAD HANZLA\AppData\Local\Programs\Python\Python312\python.exe
cachedir: .pytest_cache
rootdir: C:\Users\MUHAMMAD HANZLA\Desktop\Rag\Business-intelligence
plugins: anyio-4.9.0, langsmith-0.7.6, asyncio-1.3.0, cov-7.0.0, mock-3.15.1
asyncio: mode=Mode.STRICT, debug=False, asyncio_default_fixture_loop_scope=None, asyncio_default_test_loop_scope=function
collecting ... collected 19 items

tests/test_llm.py::test_response_not_empty FAILED                        [  5%]
tests/test_llm.py::test_validate_query_empty PASSED                      [ 10%]
tests/test_llm.py::test_validate_query_too_long PASSED                   [ 15%]
tests/test_llm.py::test_validate_query_valid PASSED                      [ 21%]
tests/test_llm.py::test_build_llm_without_key PASSED                     [ 26%]
tests/test_rag.py::test_embed_single_text PASSED                         [ 31%]
tests/test_rag.py::test_embed_batch_texts PASSED                         [ 36%]
tests/test_rag.py::test_embed_empty_string PASSED                        [ 42%]
tests/test_rag.py::test_embed_empty_list PASSED                          [ 47%]
tests/test_rag.py::test_embed_invalid_type PASSED                        [ 52%]
tests/test_rag.py::test_lru_cache_working PASSED                         [ 57%]
tests/test_rag.py::test_load_and_chunk_files_valid_txt PASSED            [ 63%]
tests/test_rag.py::test_load_and_chunk_files_empty_list PASSED           [ 68%]
tests/test_rag.py::test_load_and_chunk_files_invalid_path PASSED         [ 73%]
tests/test_rag.py::test_load_and_chunk_files_unsupported_ext PASSED      [ 78%]
tests/test_rag.py::test_upsert_pinecone_missing_key_skipped SKIPPED      [ 84%]
tests/test_rag.py::test_validate_rag_query_valid PASSED                  [ 89%]
tests/test_rag.py::test_validate_rag_query_too_short PASSED              [ 94%]
tests/test_rag.py::test_validate_rag_query_invalid_type PASSED           [100%]

================================== FAILURES ===================================
___________________________ test_response_not_empty ___________________________

llm = ChatGoogleGenerativeAI(model='models/gemini-2.5-flash', google_api_key=SecretStr('**********'), temperature=0.2, clien...e_v1beta.services.generative_service.client.GenerativeServiceClient object at 0x000001D221EE28D0>, default_metadata=())

    def test_response_not_empty(llm) -> None:
        """
        GIVEN a valid query
        WHEN the LLM is called
        THEN the response must be non-empty.
        """
>       from main import stream_rag_query
E       ImportError: cannot import name 'stream_rag_query' from 'main' (C:\Users\MUHAMMAD HANZLA\Desktop\Rag\Business-intelligence\main.py)

tests\test_llm.py:40: ImportError
============================== warnings summary ===============================
<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: Type google._upb._message.MessageMapContainer uses PyType_Spec with a metaclass that has custom tp_new. This is deprecated and will no longer be allowed in Python 3.14.

<frozen importlib._bootstrap>:488
  <frozen importlib._bootstrap>:488: DeprecationWarning: Type google._upb._message.ScalarMapContainer uses PyType_Spec with a metaclass that has custom tp_new. This is deprecated and will no longer be allowed in Python 3.14.

..\..\..\AppData\Local\Programs\Python\Python312\Lib\site-packages\langchain_google_genai\chat_models.py:47
  C:\Users\MUHAMMAD HANZLA\AppData\Local\Programs\Python\Python312\Lib\site-packages\langchain_google_genai\chat_models.py:47: FutureWarning: 
  
  All support for the `google.generativeai` package has ended. It will no longer be receiving 
  updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
  See README for more details:
  
  https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md
  
    from google.generativeai.caching import CachedContent  # type: ignore[import]

tests/test_rag.py::test_load_and_chunk_files_valid_txt
  C:\Users\MUHAMMAD HANZLA\Desktop\Rag\Business-intelligence\rag.py:225: DeprecationWarning: There is no current event loop
    loop = asyncio.get_event_loop()

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_llm.py::test_response_not_empty - ImportError: cannot impor...
============= 1 failed, 17 passed, 1 skipped, 4 warnings in 9.36s =============
